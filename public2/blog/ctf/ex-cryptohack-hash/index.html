<!DOCTYPE html>
<html lang="vi" >

<head>
    <meta charset="UTF-8"><meta http-equiv="Content-Security-Policy"
content="default-src 'self';font-src 'self' data:;img-src 'self' https://* data:;media-src 'self';style-src 'self';frame-src player.vimeo.com https://www.youtube-nocookie.com giscus.app;connect-src 'self' vhiweeypifbwacashxjz.supabase.co;script-src 'self'  giscus.app  cdn.jsdelivr.net 'self'">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="base" content="https://thanhnc.id.vn">

    
    <title>
JakeClark - Nguy·ªÖn Ch√≠ Th√†nh ‚Ä¢ CryptoHack - Hash Functions</title>

    
    
    
        <link rel=icon href='data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y="50%" x="50%" dominant-baseline="central" text-anchor="middle" font-size="88">üõ†Ô∏è</text></svg>'>
    

    
    
        
            
            
                
                    <link rel="alternate" type="application/atom+xml" title="JakeClark - Nguy·ªÖn Ch√≠ Th√†nh - Atom Feed" href="https://thanhnc.id.vn/atom.xml">
                
            
        
    

    
    
    
        
            <link rel="stylesheet" href="https://thanhnc.id.vn/custom_subset.css?h=ffa90bf9a2649dfbcdbd">
        
    

    
        <link rel="stylesheet" href="https://thanhnc.id.vn/main.css?h=045c365e19a4d50a64bb" />
        <link rel="stylesheet" href="https://thanhnc.id.vn/custom.css?h=9577bdcdedcc69cae84c" />
        <link rel="stylesheet" href="https://thanhnc.id.vn/skins/mint.css?h=504215cf6bc10586b487" />

    <meta name="color-scheme" content="light dark" />
        <meta name="theme-color" content="#087e96" />
        <meta name="description" content="Gi·∫£i c√°c b√†i t·∫≠p v·ªÅ h√†m bƒÉm (Hash Functions) tr√™n CryptoHack, bao g·ªìm Jack&#x27;s Birthday, MD5 collisions v√† Length Extension Attack." />
        <meta property="og:description" content="Gi·∫£i c√°c b√†i t·∫≠p v·ªÅ h√†m bƒÉm (Hash Functions) tr√™n CryptoHack, bao g·ªìm Jack&#x27;s Birthday, MD5 collisions v√† Length Extension Attack." />

    

    <meta property="og:title" content="CryptoHack - Hash Functions" />
    <meta property="og:type" content="article" />

    
<meta property="og:locale:alternate" content="vi_VN" />

        <link rel="alternate" hreflang="vi" href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/" />

    <meta property="og:url" content="https:&#x2F;&#x2F;thanhnc.id.vn&#x2F;blog&#x2F;ctf&#x2F;ex-cryptohack-hash&#x2F;" /><meta property="og:site_name" content="JakeClark - Nguy·ªÖn Ch√≠ Th√†nh">
        <noscript><link rel="stylesheet" href="https://thanhnc.id.vn/no_js.css"/></noscript>
        <script type="text/javascript" src="https://thanhnc.id.vn/js/initializeTheme.min.js"></script>
        <script defer src="https://thanhnc.id.vn/js/themeSwitcher.min.js"></script>
    
</head>


<body>
    <a href="#main-content" id="skip-link">B·ªè qua ƒë·∫øn n·ªôi dung</a>
    <header>
    <nav class="navbar">
        <div class="nav-title">
            <a class="home-title" href="https://thanhnc.id.vn/">JakeClark - Nguy·ªÖn Ch√≠ Th√†nh</a>
        </div>
            <div class="nav-navs">
                <ul>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://thanhnc.id.vn/projects/">d·ª± √°n
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://thanhnc.id.vn/blog/">blog
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding" href="https://thanhnc.id.vn/faq/">faq
                                </a>
                            </li>
                        <li class="menu-icons-container">
                        <ul class="menu-icons-group">
                            

                            
                            
                            <li class="language-switcher">
    <details class="dropdown">
        <summary role="button" aria-haspopup="true" title="Ch·ªçn ng√¥n ng·ªØ" aria-label="Ch·ªçn ng√¥n ng·ªØ"><div class="language-switcher-icon"></div></summary>
        <div class="dropdown-content" role="menu">Ti·∫øng Vi·ªát<a role="menuitem" lang="en" aria-label="English" href="https:&#x2F;&#x2F;thanhnc.id.vn/en/blog/ctf/ex-cryptohack-hash/">English</a></div>
    </details>
</li>


                            <li class="theme-switcher-wrapper js"><div
        title="Chuy·ªÉn sang ch·∫ø ƒë·ªô t·ªëi&#x2F;s√°ng"
        class="theme-switcher"
        tabindex="0"
        role="button"
        aria-label="Chuy·ªÉn sang ch·∫ø ƒë·ªô t·ªëi"
        aria-pressed="false">
    </div><div
        title="ƒê·∫∑t l·∫°i ch·∫ø ƒë·ªô m·∫∑c ƒë·ªãnh"
        class="theme-resetter arrow"
        tabindex="0"
        role="button"
        aria-hidden="true"
        aria-label="ƒê·∫∑t l·∫°i ch·∫ø ƒë·ªô m·∫∑c ƒë·ªãnh">
    </div>

</li>
</ul>
                    </li>
                </ul>
            </div>
        
    </nav>
</header>

    <div class="content" id="main-content">

        
        





<main>
    <article class="h-entry">
        <h1 class="p-name article-title">
            CryptoHack - Hash Functions
        </h1>
        <a class="u-url u-uid" href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/"></a>

        <ul class="meta"><span class="hidden p-author h-card">
<a rel="author" href="https:&#x2F;&#x2F;thanhnc.id.vn" class="u-url " title=""></a>
</span>
<li><time class="dt-published" datetime="2023-08-14">14 Thg 8 2023</time></li><li title="1285 t·ª´"><span class='separator' aria-hidden='true'>‚Ä¢</span>7 ph√∫t ƒë·ªçc</li><li class="tag"><span class='separator' aria-hidden='true'>‚Ä¢</span>Th·∫ª:&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/ctf/">ctf</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/cryptohack/">cryptohack</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/crypto/">crypto</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/hash/">hash</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/md5/">md5</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/length-extension/">length-extension</a>,&nbsp;</li><li class="tag"><a class="p-category" href="https://thanhnc.id.vn/tags/collison/">collison</a></li>
        </ul>
            

<div class="toc-container">
    
        <h3>M·ª•c l·ª•c</h3>
    

    <ul>
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#jack-s-birthday-hash">Jack‚Äôs Birthday Hash</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#jack-s-birthday-confusion">Jack‚Äôs Birthday Confusion</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#collider">Collider</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#hash-stuffing">Hash Stuffing</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#primed5">PriMeD5</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#md0">MD0</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#tong-ket">T·ªïng k·∫øt</a>
                    
                </li>
            
        
    </ul>
</div>


        
            <p class="p-summary" hidden>Gi·∫£i c√°c b√†i t·∫≠p v·ªÅ h√†m bƒÉm (Hash Functions) tr√™n CryptoHack, bao g·ªìm Jack&#x27;s Birthday, MD5 collisions v√† Length Extension Attack.</p><section class="e-content body"><p>Series gi·∫£i c√°c b√†i t·∫≠p v·ªÅ <strong>Hash Functions</strong> tr√™n CryptoHack.</p>
<p><strong>Author</strong>: Nguy·ªÖn Ch√≠ Th√†nh | JakeClark<br />
<strong>Date</strong>: Mon, Aug 14th, 2023</p>
<span id="continue-reading"></span>
<h2 id="jack-s-birthday-hash">Jack‚Äôs Birthday Hash</h2>
<p>V·ªõi h√†m bƒÉm <code>JACK11()</code> v√¨ gi√° tr·ªã c·ªßa n√≥ l√† 1 d√£y nh·ªã ph√¢n c√≥ 11 bit, n√™n n√≥ s·∫Ω c√≥ $2^{11}$ gi√° tr·ªã kh√°c nhau.</p>
<p>X√°c su·∫•t l·∫•y 1 gi√° tr·ªã trong s·ªë $2^{11}$ gi√° tr·ªã ƒë√≥ l√† $\frac{1}{H}$, v·ªõi $H$ trong tr∆∞·ªùng h·ª£p n√†y l√† $2^{11}$, v√¨ v·∫≠y x√°c su·∫•t kh√¥ng l·∫•y ƒë∆∞·ª£c 1 gi√° tr·ªã trong s·ªë $H$ gi√° tr·ªã l√† $1-\frac{1}{H}$, v√† x√°c su·∫•t kh√¥ng l·∫•y ƒë∆∞·ª£c $n$ gi√° tr·ªã (c√≥ th·ªÉ gi·ªëng ho·∫∑c kh√°c nhau) trong s·ªë $H$ gi√° tr·ªã l√† $(1-\frac{1}{H})^{n}$.</p>
<p>G·ªçi $P(n)$ l√† x√°c su·∫•t l·∫•y ƒë∆∞·ª£c $n$ gi√° tr·ªã (c√≥ th·ªÉ gi·ªëng ho·∫∑c kh√°c nhau) trong s·ªë $H$ gi√° tr·ªã c√≥ √≠t nh·∫•t 1 gi√° tr·ªã ƒë·ª•ng ƒë·ªô, v√† $P'(n)$ l√† x√°c su·∫•t kh√¥ng l·∫•y ƒë∆∞·ª£c $n$ gi√° tr·ªã. D·ª±a v√†o tr√™n, ta c√≥ th·ªÉ t√≠nh:</p>
<p>$$
P(n)=1-P'(n)=1-(1-\frac{1}{H})^{n}
$$</p>
<p>Theo ƒë·ªÅ b√†i, ta c·∫ßn t√¨m $n$ sao cho $P(n) \ge 50%$. Th·∫ø v√†o c√¥ng th·ª©c tr√™n, ta c√≥:</p>
<p>$$
1-(1-\frac{1}{H})^{n} \ge 50%
$$</p>
<p>Chuy·ªÉn v·∫ø, l·∫•y logarit ta c√≥:</p>
<p>$$
n = \log_{\frac{1}{2}}{(1-\frac{1}{H})} = \frac{\ln{\frac{1}{2}}}{\ln{(1-\frac{1}{H})}} \approx 1419.22
$$</p>
<p>V·∫≠y k·∫øt qu·∫£ l√† <strong>1420</strong>.</p>
<h2 id="jack-s-birthday-confusion">Jack‚Äôs Birthday Confusion</h2>
<p>G·ªçi $P(n)$ l√† x√°c su·∫•t l·∫•y ƒë∆∞·ª£c $n$ gi√° tr·ªã trong s·ªë $H$ gi√° tr·ªã c√≥ √≠t nh·∫•t 1 gi√° tr·ªã ƒë·ª•ng ƒë·ªô, $n$ gi√° tr·ªã n√†y ph·∫£i kh√°c nhau, v√† $P'(n)$ l√† x√°c su·∫•t kh√¥ng l·∫•y ƒë∆∞·ª£c $n$ gi√° tr·ªã v·ªõi $P(n)=1-P'(n)$. V·ªõi $P'(n)$, ta c√≥ th·ªÉ t√≠nh b·∫±ng $\frac{H}{H} \cdot \frac{H-1}{H} \cdot \frac{H-2}{H} \dots \frac{H-n+1}{H}$.</p>
<p>V√¨ v·∫≠y, theo ƒë·ªÅ th√¨ ta c·∫ßn t√¨m $n$ sao cho $P(n) \ge 75%$ n√™n ta c√≥:</p>
<p>$$
P(n)=1 - \left( \frac{H}{H} \cdot \frac{H-1}{H} \cdot \frac{H-2}{H} \dots \frac{H-n+1}{H} \right) \ge 75%
$$</p>
<p>Sau khi x·∫•p x·ªâ $P(n)$:</p>
<p>$$
P(n)=1-e^{-\frac{n^2}{2H}}
$$</p>
<p>Ta c√≥ th·ªÉ t√≠nh $n$ b·∫±ng c√¥ng th·ª©c:</p>
<p>$$
n = \sqrt{2H \ln(\frac{1}{1-0.75})}
$$</p>
<p>V·∫≠y k·∫øt qu·∫£ l√† <strong>75</strong>.</p>
<h2 id="collider">Collider</h2>
<p>ƒê·ªëi v·ªõi b√†i n√†y, ta nh·∫≠n th·∫•y ƒëi·ªÉm y·∫øu c·ªßa b√†i n√†y l√† s·ª≠ d·ª•ng MD5 ƒë·ªÉ bƒÉm document, v√¨ v·∫≠y ta c·∫ßn ƒë∆∞a ra cho n√≥ 2 document kh√°c nhau nh∆∞ng c√πng gi√° tr·ªã hash.</p>
<p>·ªû ƒë√¢y ta s·∫Ω s·ª≠ d·ª•ng tool t·ª´ <strong>HashClash</strong> ƒë·ªÉ t·∫°o ra 2 file kh√°c n·ªôi dung nh∆∞ng c√πng gi√° tr·ªã hash.</p>
<p>ƒê·∫ßu ti√™n ta s·∫Ω ch√®n prefix c·∫ßn c√≥ trong n·ªôi dung 2 file v√†o file <code>prefix.txt</code>:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #F38BA8;font-style: italic;">echo</span><span style="color: #A6E3A1;"> -n &quot;aaaa&quot;</span><span style="color: #94E2D5;"> &gt;</span><span style="color: #A6E3A1;"> prefix.txt</span></span></code></pre>
<p>Sau ƒë√≥ ta kh·ªüi ch·∫°y script <code>poc_no.sh</code> trong th∆∞ m·ª•c script, trong tr∆∞·ªùng h·ª£p n√†y c√¢y th∆∞ m·ª•c g·ªìm:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="plain"><span class="giallo-l"><span>hashclash</span></span>
<span class="giallo-l"><span>|---cpc_workdir</span></span>
<span class="giallo-l"><span>|   |--- prefix.txt</span></span>
<span class="giallo-l"><span>|---scripts</span></span>
<span class="giallo-l"><span>    |--- poc_no.sh</span></span></code></pre>
<p>Th√¨ l·ªánh s·∫Ω l√†:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #F38BA8;font-style: italic;">.</span><span style="color: #A6E3A1;">./scripts/poc_no.sh prefix.txt</span></span></code></pre>
<p>Sau khi ch·∫°y xong n√≥ s·∫Ω t·∫°o 2 file, <code>collision1.bin</code> v√† <code>collision2.bin</code> trong th∆∞ m·ª•c <code>cpc_workdir</code>, ƒë·ªÉ chuy·ªÉn ƒë·ªïi th√†nh d·∫°ng hex ƒë∆∞a v√†o server ta d√πng:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="shellscript"><span class="giallo-l"><span style="color: #89B4FA;font-style: italic;">xxd</span><span style="color: #A6E3A1;"> -p collision1.bin</span></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;"># 61616161c8e1a15b18ce694a9a8600a4469572661898abb4dd3ff30419438a27ddeb313be505ebc9c7c41d41b3335718cc1b5b40d0fcdd2d44813310d0a2789ffcdac846fabb2edb83a45e8f3421d5b94748ce85fc03d2e4dac603d373d0fd9eecf6d0c8770b4cd41915194c4a9cb3ade061a780ab23fbc098d067b318e66f64</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #89B4FA;font-style: italic;">xxd</span><span style="color: #A6E3A1;"> -p collision2.bin</span></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;"># 61616161c8e1a15b18cf694a9a8600a4469572661898abb4dd3ff30419438a27ddeb313be505ebc9c7c41d41b3335718cc1b5b40d0fcdd2d44813310d0a2789ffcdac846fabb2edb83a35e8f3421d5b94748ce85fc03d2e4dac603d373d0fd9eecf6d0c8770b4cd41915194c4a9cb3ade061a780ab23fbc098d067b318e66f64</span></span></code></pre>
<p>Sau ƒë√≥ ta ƒë∆∞a v√†o server l·∫ßn l∆∞·ª£t:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="json"><span class="giallo-l"><span style="color: #9399B2;">{&quot;</span><span style="color: #89B4FA;">document</span><span style="color: #9399B2;">&quot;:</span><span style="color: #A6E3A1;"> &quot;61616161c8e1a15b18ce694a9a8600a4469572661898abb4dd3ff30419438a27ddeb313be505ebc9c7c41d41b3335718cc1b5b40d0fcdd2d44813310d0a2789ffcdac846fabb2edb83a45e8f3421d5b94748ce85fc03d2e4dac603d373d0fd9eecf6d0c8770b4cd41915194c4a9cb3ade061a780ab23fbc098d067b318e66f64&quot;</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span style="color: #9399B2;">{&quot;</span><span style="color: #89B4FA;">document</span><span style="color: #9399B2;">&quot;:</span><span style="color: #A6E3A1;"> &quot;61616161c8e1a15b18cf694a9a8600a4469572661898abb4dd3ff30419438a27ddeb313be505ebc9c7c41d41b3335718cc1b5b40d0fcdd2d44813310d0a2789ffcdac846fabb2edb83a35e8f3421d5b94748ce85fc03d2e4dac603d373d0fd9eecf6d0c8770b4cd41915194c4a9cb3ade061a780ab23fbc098d067b318e66f64&quot;</span><span style="color: #9399B2;">}</span></span></code></pre><h2 id="hash-stuffing">Hash Stuffing</h2>
<p>ƒê·ªëi v·ªõi b√†i n√†y ta c√≥ 1 h√†m bƒÉm ri√™ng, tuy nhi√™n l·ªó h·ªïng l√† ·ªü ch·ªó padding, khi chu·ªói msg ƒë√£ ƒë·ªß 64 byte n√≥ kh√¥ng ch√®n g√¨ th√™m nh∆∞ nh·ªØng thu·∫≠t to√°n padding kh√°c:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">def</span><span style="color: #89B4FA;font-style: italic;"> pad</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">data</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span>    padding_len</span><span style="color: #94E2D5;"> =</span><span style="color: #9399B2;"> (</span><span>BLOCK_SIZE</span><span style="color: #94E2D5;"> -</span><span style="color: #FAB387;font-style: italic;"> len</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">))</span><span style="color: #94E2D5;"> %</span><span> BLOCK_SIZE</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    return</span><span> data</span><span style="color: #94E2D5;"> +</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">([</span><span>padding_len</span><span style="color: #9399B2;">]</span><span style="color: #94E2D5;">*</span><span>padding_len</span><span style="color: #9399B2;">)</span></span></code></pre>
<p>Ch√≠nh v√¨ v·∫≠y ta c√≥ th·ªÉ ƒë∆∞a cho n√≥ 2 chu·ªói, 1 chu·ªói ch∆∞a padding v√† 1 chu·ªói ƒë√£ padding theo c√°ch tr√™n, theo l√Ω thuy·∫øt 2 chu·ªói n√†y kh√°c nhau nh∆∞ng c√πng m√£ bƒÉm.</p>
<p><strong>Script</strong>:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">import</span><span> json</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> pwn</span><span style="color: #CBA6F7;"> import</span><span> remote</span></span>
<span class="giallo-l"><span>BLOCK_SIZE</span><span style="color: #94E2D5;"> =</span><span style="color: #FAB387;"> 32</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">def</span><span style="color: #89B4FA;font-style: italic;"> pad</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">data</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span>    padding_len</span><span style="color: #94E2D5;"> =</span><span style="color: #9399B2;"> (</span><span>BLOCK_SIZE</span><span style="color: #94E2D5;"> -</span><span style="color: #FAB387;font-style: italic;"> len</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">))</span><span style="color: #94E2D5;"> %</span><span> BLOCK_SIZE</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    return</span><span> data</span><span style="color: #94E2D5;"> +</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">([</span><span>padding_len</span><span style="color: #9399B2;">]</span><span style="color: #94E2D5;">*</span><span>padding_len</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>io</span><span style="color: #9399B2;">:</span><span> remote</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> remote</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;socket.cryptohack.org&quot;</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 13405</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">try</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvuntil</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&quot;JSON: &quot;</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">sendline</span><span style="color: #9399B2;">(</span><span>json</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">dumps</span><span style="color: #9399B2;">({</span><span style="color: #A6E3A1;">&quot;m1&quot;</span><span style="color: #9399B2;">: (</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&quot;1&quot;</span><span style="color: #94E2D5;">*</span><span style="color: #FAB387;">63</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">(),</span><span style="color: #A6E3A1;"> &quot;m2&quot;</span><span style="color: #9399B2;">:</span><span style="color: #89B4FA;"> pad</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&quot;1&quot;</span><span style="color: #94E2D5;">*</span><span style="color: #FAB387;">63</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">()}).</span><span style="color: #89B4FA;">encode</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">    print</span><span style="color: #9399B2;">(</span><span>json</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">dumps</span><span style="color: #9399B2;">({</span><span style="color: #A6E3A1;">&quot;m1&quot;</span><span style="color: #9399B2;">: (</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&quot;1&quot;</span><span style="color: #94E2D5;">*</span><span style="color: #FAB387;">63</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">(),</span><span style="color: #A6E3A1;"> &quot;m2&quot;</span><span style="color: #9399B2;">:</span><span style="color: #89B4FA;"> pad</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&quot;1&quot;</span><span style="color: #94E2D5;">*</span><span style="color: #FAB387;">63</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">()}))</span></span>
<span class="giallo-l"><span>    resp</span><span style="color: #94E2D5;"> =</span><span> io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">    print</span><span style="color: #9399B2;">(</span><span>resp</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">finally</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">close</span><span style="color: #9399B2;">()</span></span></code></pre><h2 id="primed5">PriMeD5</h2>
<p>ƒê·ªëi v·ªõi b√†i n√†y, 1 l·∫ßn n·ªØa ta th·∫•y ·ªü ph·∫ßn k√Ω:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">elif</span><span style="color: #EBA0AC;font-style: italic;"> msg</span><span style="color: #9399B2;">[</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #A6E3A1;font-style: italic;">option</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">]</span><span style="color: #94E2D5;"> ==</span><span style="color: #A6E3A1;"> &quot;sign&quot;</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>		p</span><span style="color: #94E2D5;"> =</span><span style="color: #CBA6F7;font-style: italic;"> int</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">msg</span><span style="color: #9399B2;">[</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #A6E3A1;font-style: italic;">prime</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">])</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">		if</span><span> p</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">bit_length</span><span style="color: #9399B2;">()</span><span style="color: #94E2D5;"> &gt;</span><span style="color: #FAB387;"> 1024</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">		    return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;error&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;The prime is too large.&quot;</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">		if not</span><span style="color: #89B4FA;"> isPrime</span><span style="color: #9399B2;">(</span><span>p</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">		    return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;error&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;You must specify a prime.&quot;</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span>		</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">		hash</span><span style="color: #94E2D5;"> =</span><span> MD5</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">new</span><span style="color: #9399B2;">(</span><span style="color: #89B4FA;">long_to_bytes</span><span style="color: #9399B2;">(</span><span>p</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"><span>		sig</span><span style="color: #94E2D5;"> =</span><span> sig_scheme</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">sign</span><span style="color: #9399B2;">(</span><span style="color: #FAB387;font-style: italic;">hash</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">		return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;signature&quot;</span><span style="color: #9399B2;">:</span><span> sig</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">()}</span></span></code></pre>
<p>N√≥ ch·ªâ ƒë∆∞a v√†o gi√° tr·ªã MD5 c·ªßa s·ªë nguy√™n t·ªë $p$ v√†o h√†m k√Ω, v√¨ v·∫≠y ƒë√¢y l√† l·ªó h·ªïng th·ª© nh·∫•t.</p>
<p>·ªû ph·∫ßn x√°c nh·∫≠n ch·ªØ k√Ω:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">elif</span><span style="color: #EBA0AC;font-style: italic;"> msg</span><span style="color: #9399B2;">[</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #A6E3A1;font-style: italic;">option</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">]</span><span style="color: #94E2D5;"> ==</span><span style="color: #A6E3A1;"> &quot;check&quot;</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>    p</span><span style="color: #94E2D5;"> =</span><span style="color: #CBA6F7;font-style: italic;"> int</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">msg</span><span style="color: #9399B2;">[</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #A6E3A1;font-style: italic;">prime</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">])</span></span>
<span class="giallo-l"><span>    sig</span><span style="color: #94E2D5;"> =</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">msg</span><span style="color: #9399B2;">[</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #A6E3A1;font-style: italic;">signature</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">])</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">    hash</span><span style="color: #94E2D5;"> =</span><span> MD5</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">new</span><span style="color: #9399B2;">(</span><span style="color: #89B4FA;">long_to_bytes</span><span style="color: #9399B2;">(</span><span>p</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    try</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>        sig_scheme</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">verify</span><span style="color: #9399B2;">(</span><span style="color: #FAB387;font-style: italic;">hash</span><span style="color: #9399B2;">,</span><span> sig</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    except</span><span style="color: #FAB387;font-style: italic;"> ValueError</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">        return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;error&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;Invalid signature.&quot;</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span>    a</span><span style="color: #94E2D5;"> =</span><span style="color: #CBA6F7;font-style: italic;"> int</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">msg</span><span style="color: #9399B2;">[</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #A6E3A1;font-style: italic;">a</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">])</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    if</span><span> a</span><span style="color: #94E2D5;"> &lt;</span><span style="color: #FAB387;"> 1</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">        return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;error&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;`a` value invalid&quot;</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    if</span><span> a</span><span style="color: #94E2D5;"> &gt;=</span><span> p</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">        return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;error&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;`a` value too large&quot;</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span>    g</span><span style="color: #94E2D5;"> =</span><span> math</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">gcd</span><span style="color: #9399B2;">(</span><span>a</span><span style="color: #9399B2;">,</span><span> p</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span>    flag_byte</span><span style="color: #94E2D5;"> =</span><span style="color: #EBA0AC;font-style: italic;"> FLAG</span><span style="color: #9399B2;">[:</span><span style="color: #EBA0AC;font-style: italic;">g</span><span style="color: #9399B2;">]</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    return</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;msg&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;font-style: italic;"> f</span><span style="color: #A6E3A1;">&quot;Valid signature. First byte of flag: </span><span style="color: #F5C2E7;">{</span><span>flag_byte</span><span style="color: #F5C2E7;">}</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #9399B2;">}</span></span></code></pre>
<p>N·∫øu ƒë√∫ng nh∆∞ tr√™n th√¨: $p$ ƒë∆∞a v√†o l√† 1 s·ªë nguy√™n t·ªë th√¨ b·∫•t k·ª≥ $a$ n√†o b√© h∆°n $p$ ƒë·ªÅu c√≥ $gcd(a, p)=1$, tuy nhi√™n l·ªó h·ªïng ·ªü ƒë√¢y l√† kh√¥ng x√°c th·ª±c $p$ c√≥ ph·∫£i l√† s·ªë nguy√™n t·ªë hay kh√¥ng. V√¨ v·∫≠y ta s·∫Ω c·∫ßn t√¨m:</p>
<ul>
<li>1 s·ªë nguy√™n t·ªë $p1$ ƒë·ªÉ k√Ω.</li>
<li>1 s·ªë kh√¥ng ph·∫£i nguy√™n t·ªë $p2$ ƒë·ªÉ x√°c th·ª±c sao cho $md5(p1) = md5(p2)$ v√† ƒë·ªß l·ªõn.</li>
<li>1 s·ªë $a$ sao cho $gcd(p', a) \ge 30$, s·ªë 30 n√†y l√† 1 s·ªë ∆∞·ªõc ch·ª´ng v√¨ trong Python, n·∫øu ta d√πng <code>FLAG[:g]</code> v·ªõi $g \ge len(FLAG)$ th√¨ ch∆∞∆°ng tr√¨nh v·∫´n in h·∫øt chu·ªói $FLAG$.</li>
</ul>
<p>1 t√≠nh ch·∫•t c·ªßa h√†m bƒÉm l√† n·∫øu $hash(p1) = hash(p2)$ th√¨ v·ªõi b·∫•t k·ª≥ chu·ªói $c$ n√†o, ta lu√¥n c√≥ $hash(p1||c) = hash(p2||c)$ v·ªõi ‚Äú||‚Äù l√† ph√©p n·ªëi 2 chu·ªói l·∫°i v·ªõi nhau.</p>
<p>V√¨ v·∫≠y ta d√πng ph∆∞∆°ng ph√°p brute-force ƒë·ªÉ t√¨m m·ªôt gi√° tr·ªã $c$ sao cho khi ƒë·ªïi 2 chu·ªói bytes $p1||c$ v√† $p2||c$ th√†nh s·ªë, ta nh·∫≠n ƒë∆∞·ª£c 1 s·ªë nguy√™n t·ªë v√† 1 s·ªë kh√¥ng ph·∫£i nguy√™n t·ªë.</p>
<p>Sau ƒë√≥ ta ti·∫øp t·ª•c brute-force $a$ ƒë·ªÉ th·ªèa ƒëi·ªÅu ki·ªán $gcd(p', a) \ge 30$.</p>
<p>·ªû ƒë√¢y ta s·∫Ω kh√¥ng d√πng l·∫°i 2 chu·ªói t·ª´ b√†i Collider ƒë·ªÉ ƒë∆∞a v√†o $p1$ v√† $p2$ v√¨ tr√¥ng c√≥ v·∫ª r·∫•t l·ªõn n√™n ta s·∫Ω d√πng 2 chu·ªói kh√°c ƒë·ªÉ thay th·∫ø.</p>
<p><strong>Script</strong>:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> Crypto</span><span style="color: #9399B2;">.</span><span>Util</span><span style="color: #9399B2;">.</span><span>number</span><span style="color: #CBA6F7;"> import</span><span> isPrime</span><span style="color: #9399B2;">,</span><span> bytes_to_long</span><span style="color: #9399B2;">,</span><span> long_to_bytes</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">import</span><span> hashlib</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> math</span><span style="color: #CBA6F7;"> import</span><span> gcd</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>p1_hex</span><span style="color: #94E2D5;"> =</span><span style="color: #A6E3A1;"> &quot;0e306561559aa787d00bc6f70bbdfe3404cf03659e704f8534c00ffb659c4c8740cc942feb2da115a3f4155cbb8607497386656d7d1f34a42059d78f5a8dd1ef&quot;</span></span>
<span class="giallo-l"><span>p2_hex</span><span style="color: #94E2D5;"> =</span><span style="color: #A6E3A1;"> &quot;0e306561559aa787d00bc6f70bbdfe3404cf03659e744f8534c00ffb659c4c8740cc942feb2da115a3f415dcbb8607497386656d7d1f34a42059d78f5a8dd1ef&quot;</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>p1_num</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> bytes_to_long</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span>p1_hex</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"><span>p2_num</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> bytes_to_long</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span>p2_hex</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;p1: &quot;</span><span style="color: #9399B2;">,</span><span> p1_num</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;md5(p1): &quot;</span><span style="color: #9399B2;">,</span><span> hashlib</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">md5</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span>p1_hex</span><span style="color: #9399B2;">)).</span><span style="color: #89B4FA;">hexdigest</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;md5(p2): &quot;</span><span style="color: #9399B2;">,</span><span> hashlib</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">md5</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span>p2_hex</span><span style="color: #9399B2;">)).</span><span style="color: #89B4FA;">hexdigest</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>c</span><span style="color: #94E2D5;"> =</span><span style="color: #FAB387;"> 1</span></span>
<span class="giallo-l"><span>p1_plus_c</span><span style="color: #94E2D5;"> =</span><span style="color: #FAB387;"> 0</span></span>
<span class="giallo-l"><span>p2_plus_c</span><span style="color: #94E2D5;"> =</span><span style="color: #FAB387;"> 0</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">while</span><span style="color: #FAB387;"> True</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;">    # append 1s until prime</span></span>
<span class="giallo-l"><span>    p1_plus_c</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> bytes_to_long</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span>p1_hex</span><span style="color: #9399B2;">)</span><span style="color: #94E2D5;"> +</span><span style="color: #89B4FA;"> long_to_bytes</span><span style="color: #9399B2;">(</span><span>c</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"><span>    p2_plus_c</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> bytes_to_long</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span>p2_hex</span><span style="color: #9399B2;">)</span><span style="color: #94E2D5;"> +</span><span style="color: #89B4FA;"> long_to_bytes</span><span style="color: #9399B2;">(</span><span>c</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    if</span><span style="color: #89B4FA;"> isPrime</span><span style="color: #9399B2;">(</span><span>p1_plus_c</span><span style="color: #9399B2;">)</span><span style="color: #CBA6F7;"> and not</span><span style="color: #89B4FA;"> isPrime</span><span style="color: #9399B2;">(</span><span>p2_plus_c</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">        break</span></span>
<span class="giallo-l"><span>    c</span><span style="color: #94E2D5;"> +=</span><span style="color: #FAB387;"> 2</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;Prime:&quot;</span><span style="color: #9399B2;">,</span><span> p1_plus_c</span><span style="color: #9399B2;">,</span><span> p1_plus_c</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">bit_length</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;Not Prime:&quot;</span><span style="color: #9399B2;">,</span><span> p2_plus_c</span><span style="color: #9399B2;">,</span><span> p2_plus_c</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">bit_length</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;md5(Prime): &quot;</span><span style="color: #9399B2;">,</span><span> hashlib</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">md5</span><span style="color: #9399B2;">(</span><span style="color: #89B4FA;">long_to_bytes</span><span style="color: #9399B2;">(</span><span>p1_plus_c</span><span style="color: #9399B2;">)).</span><span style="color: #89B4FA;">hexdigest</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;md5(Not Prime): &quot;</span><span style="color: #9399B2;">,</span><span> hashlib</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">md5</span><span style="color: #9399B2;">(</span><span style="color: #89B4FA;">long_to_bytes</span><span style="color: #9399B2;">(</span><span>p2_plus_c</span><span style="color: #9399B2;">)).</span><span style="color: #89B4FA;">hexdigest</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">for</span><span> i</span><span style="color: #CBA6F7;"> in</span><span style="color: #FAB387;font-style: italic;"> range</span><span style="color: #9399B2;">(</span><span style="color: #FAB387;">20</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 1_000_000</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    if</span><span style="color: #89B4FA;"> gcd</span><span style="color: #9399B2;">(</span><span>p2_plus_c</span><span style="color: #9399B2;">,</span><span> i</span><span style="color: #9399B2;">)</span><span style="color: #94E2D5;"> &gt;=</span><span style="color: #FAB387;"> 20</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>        a</span><span style="color: #94E2D5;"> =</span><span> i</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">        print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;a = &quot;</span><span style="color: #9399B2;">,</span><span> i</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">        break</span></span></code></pre>
<p>Sau khi c√≥ ƒë∆∞·ª£c 3 gi√° tr·ªã <code>p1_plus_c</code>, <code>p2_plus_c</code> v√† <code>a</code>, ta ƒë∆∞a ch√∫ng v√†o trong server:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> pwn</span><span style="color: #CBA6F7;"> import</span><span> remote</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">import</span><span> json</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span>io</span><span style="color: #9399B2;">:</span><span> remote</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> remote</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;socket.cryptohack.org&quot;</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 13392</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">try</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"><span>    data</span><span style="color: #94E2D5;"> =</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;option&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;sign&quot;</span><span style="color: #9399B2;">,</span><span style="color: #A6E3A1;"> &quot;prime&quot;</span><span style="color: #9399B2;">:</span><span> p1_plus_c</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">sendline</span><span style="color: #9399B2;">(</span><span>json</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">dumps</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">encode</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span>    resp</span><span style="color: #94E2D5;"> =</span><span> io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"><span>    sig</span><span style="color: #94E2D5;"> =</span><span> json</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">loads</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">resp</span><span style="color: #9399B2;">[:</span><span style="color: #94E2D5;">-</span><span style="color: #FAB387;font-style: italic;">1</span><span style="color: #9399B2;">])[</span><span style="color: #A6E3A1;">&quot;signature&quot;</span><span style="color: #9399B2;">]</span></span>
<span class="giallo-l"><span>    data</span><span style="color: #94E2D5;"> =</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;option&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;check&quot;</span><span style="color: #9399B2;">,</span><span style="color: #A6E3A1;"> &quot;prime&quot;</span><span style="color: #9399B2;">:</span><span> p2_plus_c</span><span style="color: #9399B2;">,</span><span style="color: #A6E3A1;"> &quot;signature&quot;</span><span style="color: #9399B2;">:</span><span> sig</span><span style="color: #9399B2;">,</span><span style="color: #A6E3A1;"> &quot;a&quot;</span><span style="color: #9399B2;">:</span><span> a</span><span style="color: #9399B2;">}</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">sendline</span><span style="color: #9399B2;">(</span><span>json</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">dumps</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">encode</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span>    resp</span><span style="color: #94E2D5;"> =</span><span> io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">    print</span><span style="color: #9399B2;">(</span><span>resp</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">finally</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">close</span><span style="color: #9399B2;">()</span></span></code></pre><h2 id="md0">MD0</h2>
<p>N·∫øu ta ph√¢n t√≠ch h√†m bƒÉm c·ªßa challenge:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">def</span><span style="color: #FAB387;font-style: italic;"> hash</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">data</span><span style="color: #9399B2;">:</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">) -&gt;</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>    data</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> pad</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span>    out</span><span style="color: #94E2D5;"> =</span><span style="color: #A6E3A1;font-style: italic;"> b</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #F5C2E7;">\x00</span><span style="color: #A6E3A1;">&quot;</span><span style="color: #94E2D5;"> *</span><span style="color: #FAB387;"> 16</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    for</span><span> i</span><span style="color: #CBA6F7;"> in</span><span style="color: #FAB387;font-style: italic;"> range</span><span style="color: #9399B2;">(</span><span style="color: #FAB387;">0</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;font-style: italic;"> len</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">),</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span>        blk</span><span style="color: #94E2D5;"> =</span><span style="color: #EBA0AC;font-style: italic;"> data</span><span style="color: #9399B2;">[</span><span style="color: #EBA0AC;font-style: italic;">i</span><span style="color: #9399B2;">:</span><span style="color: #EBA0AC;font-style: italic;">i</span><span style="color: #94E2D5;">+</span><span style="color: #FAB387;font-style: italic;">16</span><span style="color: #9399B2;">]</span></span>
<span class="giallo-l"><span>        out</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> bxor</span><span style="color: #9399B2;">(</span><span>AES</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">new</span><span style="color: #9399B2;">(</span><span>blk</span><span style="color: #9399B2;">,</span><span> AES</span><span style="color: #9399B2;">.</span><span>MODE_ECB</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">encrypt</span><span style="color: #9399B2;">(</span><span>out</span><span style="color: #9399B2;">),</span><span> out</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    return</span><span> out</span></span></code></pre>
<p>Kh√°i qu√°t c√°ch h√†m ho·∫°t ƒë·ªông:</p>
<p><img src="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/Untitled.png" alt="C·∫•u tr√∫c h√†m bƒÉm" /></p>
<p>V√¨ v·∫≠y c·∫•u tr√∫c g·∫ßn gi·ªëng c·∫•u tr√∫c Merkle‚ÄìDamg√•rd, v√† ch∆∞∆°ng tr√¨nh kh√¥ng x√°c th·ª±c n·ªôi dung trong message, n√™n ta c√≥ th·ªÉ s·ª≠ d·ª•ng length extension attack ƒë·ªÉ t·∫°o ra 1 chu·ªói message kh√°c v·ªõi m√£ hash kh√°c m√† kh√¥ng c·∫ßn bi·∫øt n·ªôi dung c·ªßa key.</p>
<p>M√£ hash tr·∫£ v·ªÅ sau khi k√Ω xong bao g·ªìm chu·ªói key n·ªëi v·ªõi message ƒë√£ ƒë∆∞·ª£c padding, v√¨ v·∫≠y ta c√≥ th·ªÉ n·ªëi d√†i chu·ªói message nh∆∞ sau:</p>
<p><img src="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/Untitled1.png" alt="Length Extension Attack" /></p>
<p>ƒê√≥ ch√≠nh l√† √Ω t∆∞·ªüng c·ªßa code t·∫•n c√¥ng:</p>
<pre class="giallo" style="color: #CDD6F4; background-color: #1E1E2E;"><code data-lang="python"><span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> Crypto</span><span style="color: #9399B2;">.</span><span>Cipher</span><span style="color: #CBA6F7;"> import</span><span> AES</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> Crypto</span><span style="color: #9399B2;">.</span><span>Util</span><span style="color: #9399B2;">.</span><span>Padding</span><span style="color: #CBA6F7;"> import</span><span> pad</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">from</span><span> pwn</span><span style="color: #CBA6F7;"> import</span><span> remote</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">import</span><span> json</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">def</span><span style="color: #89B4FA;font-style: italic;"> bxor</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">a</span><span style="color: #9399B2;">,</span><span style="color: #EBA0AC;font-style: italic;"> b</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    return</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">(</span><span>x</span><span style="color: #94E2D5;"> ^</span><span> y</span><span style="color: #CBA6F7;"> for</span><span> x</span><span style="color: #9399B2;">,</span><span> y</span><span style="color: #CBA6F7;"> in</span><span style="color: #FAB387;font-style: italic;"> zip</span><span style="color: #9399B2;">(</span><span>a</span><span style="color: #9399B2;">,</span><span> b</span><span style="color: #9399B2;">))</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">def</span><span style="color: #89B4FA;font-style: italic;"> main</span><span style="color: #9399B2;">():</span></span>
<span class="giallo-l"><span>    io</span><span style="color: #9399B2;">:</span><span> remote</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> remote</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;socket.cryptohack.org&quot;</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 13388</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    try</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>        io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"><span>        io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">sendline</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&#39;{&quot;option&quot;: &quot;sign&quot;, &quot;message&quot;: &quot;11&quot;}&#39;</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">encode</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span>        io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvuntil</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&#39;&quot;: &quot;&#39;</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span>        resp</span><span style="color: #9399B2;">:</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #94E2D5;"> =</span><span> io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvuntil</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&#39;&quot;&#39;</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span>        io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;">        # Start length extension attack</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">        print</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">str</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">resp</span><span style="color: #9399B2;">[:</span><span style="color: #94E2D5;">-</span><span style="color: #FAB387;font-style: italic;">1</span><span style="color: #9399B2;">].</span><span style="color: #89B4FA;">decode</span><span style="color: #9399B2;">()))</span><span style="color: #9399B2;font-style: italic;"> # Remove &quot;\n&quot; at tail.</span></span>
<span class="giallo-l"><span>        out</span><span style="color: #9399B2;">:</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #94E2D5;"> =</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">str</span><span style="color: #9399B2;">(</span><span style="color: #EBA0AC;font-style: italic;">resp</span><span style="color: #9399B2;">[:</span><span style="color: #94E2D5;">-</span><span style="color: #FAB387;font-style: italic;">1</span><span style="color: #9399B2;">].</span><span style="color: #89B4FA;">decode</span><span style="color: #9399B2;">()))</span></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;">        # hex of &quot;admin=True&quot;: 61 64 6d 69 6e 3d 54 72 75 65</span></span>
<span class="giallo-l"><span>        data</span><span style="color: #9399B2;">:</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> pad</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;61646d696e3d54727565&quot;</span><span style="color: #9399B2;">),</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"><span style="color: #CBA6F7;">        for</span><span> i</span><span style="color: #CBA6F7;"> in</span><span style="color: #FAB387;font-style: italic;"> range</span><span style="color: #9399B2;">(</span><span style="color: #FAB387;">0</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;font-style: italic;"> len</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">),</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">):</span></span>
<span class="giallo-l"><span>            blk</span><span style="color: #94E2D5;"> =</span><span style="color: #EBA0AC;font-style: italic;"> data</span><span style="color: #9399B2;">[</span><span style="color: #EBA0AC;font-style: italic;">i</span><span style="color: #9399B2;">:</span><span style="color: #EBA0AC;font-style: italic;">i</span><span style="color: #94E2D5;">+</span><span style="color: #FAB387;font-style: italic;">16</span><span style="color: #9399B2;">]</span></span>
<span class="giallo-l"><span>            out</span><span style="color: #94E2D5;"> =</span><span style="color: #89B4FA;"> bxor</span><span style="color: #9399B2;">(</span><span>AES</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">new</span><span style="color: #9399B2;">(</span><span>blk</span><span style="color: #9399B2;">,</span><span> AES</span><span style="color: #9399B2;">.</span><span>MODE_ECB</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">encrypt</span><span style="color: #9399B2;">(</span><span>out</span><span style="color: #9399B2;">),</span><span> out</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;">        # Print output</span></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">        print</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&quot;11&quot;</span><span style="color: #94E2D5;">+</span><span style="color: #89B4FA;">pad</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&#39;11&#39;</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">)</span><span style="color: #94E2D5;">+</span><span style="color: #89B4FA;">pad</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;font-style: italic;">b</span><span style="color: #A6E3A1;">&#39;admin=True&#39;</span><span style="color: #9399B2;">,</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">),</span><span> out</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #9399B2;font-style: italic;">        # Setup</span></span>
<span class="giallo-l"><span>        data</span><span style="color: #9399B2;">:</span><span style="color: #CBA6F7;font-style: italic;"> dict</span><span style="color: #94E2D5;"> =</span><span style="color: #9399B2;"> {</span><span style="color: #A6E3A1;">&quot;option&quot;</span><span style="color: #9399B2;">:</span><span style="color: #A6E3A1;"> &quot;get_flag&quot;</span><span style="color: #9399B2;">,</span><span style="color: #A6E3A1;"> &quot;message&quot;</span><span style="color: #9399B2;">: (</span><span style="color: #89B4FA;">pad</span><span style="color: #9399B2;">(</span><span style="color: #CBA6F7;font-style: italic;">bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;11&quot;</span><span style="color: #9399B2;">),</span><span style="color: #FAB387;"> 16</span><span style="color: #9399B2;">)</span><span style="color: #94E2D5;"> +</span><span style="color: #CBA6F7;font-style: italic;"> bytes</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">fromhex</span><span style="color: #9399B2;">(</span><span style="color: #A6E3A1;">&quot;61646d696e3d54727565&quot;</span><span style="color: #9399B2;">)).</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">(),</span><span style="color: #A6E3A1;"> &quot;signature&quot;</span><span style="color: #9399B2;">:</span><span> out</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">hex</span><span style="color: #9399B2;">()}</span></span>
<span class="giallo-l"><span>        io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">sendline</span><span style="color: #9399B2;">(</span><span>json</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">dumps</span><span style="color: #9399B2;">(</span><span>data</span><span style="color: #9399B2;">).</span><span style="color: #89B4FA;">encode</span><span style="color: #9399B2;">())</span></span>
<span class="giallo-l"><span>        resp</span><span style="color: #94E2D5;"> =</span><span> io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">recvline</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #FAB387;font-style: italic;">        print</span><span style="color: #9399B2;">(</span><span>resp</span><span style="color: #9399B2;">)</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">    finally</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span>        io</span><span style="color: #9399B2;">.</span><span style="color: #89B4FA;">close</span><span style="color: #9399B2;">()</span></span>
<span class="giallo-l"></span>
<span class="giallo-l"><span style="color: #CBA6F7;">if</span><span> __name__</span><span style="color: #94E2D5;"> ==</span><span style="color: #A6E3A1;"> &quot;__main__&quot;</span><span style="color: #9399B2;">:</span></span>
<span class="giallo-l"><span style="color: #89B4FA;">    main</span><span style="color: #9399B2;">()</span></span></code></pre><h2 id="tong-ket">T·ªïng k·∫øt</h2>
<p>T√≥m t·∫Øt l·∫°i nh·ªØng √Ω ch√≠nh trong ph·∫ßn n√†y:</p>
<ul>
<li>V·ªõi 1 h√†m bƒÉm c√≥ $H$ gi√° tr·ªã c√≥ th·ªÉ bƒÉm ƒë∆∞·ª£c, s·ªë l∆∞·ª£ng gi√° tr·ªã $n$ kh√°c nhau ƒë·ªÉ ƒë·∫°t x√°c su·∫•t $P(n)$ c√≥ √≠t nh·∫•t 1 c·∫∑p gi√° tr·ªã ƒë·ª•ng ƒë·ªô l√†:</li>
</ul>
<p>$$
n = \sqrt{2H \ln(\frac{1}{1-P(n)})}
$$</p>
<ul>
<li>V√≠ d·ª• h√†m bƒÉm MD5 cho ra t·ªïng c·ªông $2^{64}$ gi√° tr·ªã, d·ª±a v√†o c√¥ng th·ª©c tr√™n s·ªë l∆∞·ª£ng gi√° tr·ªã $n$ kh√°c nhau ƒë·ªÉ ƒë·∫°t x√°c su·∫•t 50% c√≥ √≠t nh·∫•t 1 c·∫∑p gi√° tr·ªã ƒë·ª•ng ƒë·ªô l√† h∆°n 5 t·ªâ gi√° tr·ªã (kh√° l·ªõn so v·ªõi c√¥ng th·ª©c th∆∞·ªùng d√πng l√† $2^{\frac{n}{2}}$ ho·∫∑c $\sqrt{n}$).</li>
<li>Kh√¥ng s·ª≠ d·ª•ng MD5, SHA1 v√† nh·ªØng h√†m bƒÉm y·∫øu kh√°c (d·ªÖ t√¨m ra ƒë·ª•ng ƒë·ªô) ƒë·ªÉ bƒÉm c√°c d·ªØ li·ªáu nh·∫°y c·∫£m.</li>
<li>Trong qu√° tr√¨nh padding, n·∫øu d·ªØ li·ªáu ƒë·∫°t t·ªõi <code>BLOCK_SIZE</code> byte th√¨ n√™n ti·∫øp t·ª•c padding block k·∫ø ti·∫øp.</li>
<li>N·∫øu t√¨m ra 2 chu·ªói sao cho $hash(a)=hash(b)$ v·ªõi $a \neq b$ th√¨ ta c√≥ th·ªÉ t√¨m ƒë∆∞·ª£c m·ªôt chu·ªói $c$ sao cho $hash(a||c) = hash(b||c)$.</li>
<li>N·∫øu h√†m bƒÉm d√πng ƒë·ªÉ x√°c th·ª±c ch·ªØ k√Ω <code>data</code> v·ªõi <code>hash(secret||data)</code> s·ª≠ d·ª•ng c·∫•u tr√∫c g·∫ßn ho·∫∑c gi·ªëng Merkle‚ÄìDamg√•rd, ta c√≥ th·ªÉ d√πng ph∆∞∆°ng ph√°p t·∫•n c√¥ng m·ªü r·ªông chi·ªÅu d√†i chu·ªói (length extension attack).</li>
</ul>
<p>V√¨ v·∫≠y, kh√¥ng n√™n s·ª≠ d·ª•ng MD5, SHA1, SHA256, SHA512 v√† nh·ªØng h√†m bƒÉm kh√°c s·ª≠ d·ª•ng c·∫•u tr√∫c Merkle‚ÄìDamg√•rd ƒë·ªÉ k√Ω <code>data</code> v·ªõi <code>hash(secret||data)</code>.</p>

        </section><form method="post" action="https://vhiweeypifbwacashxjz.supabase.co/rest/v1/rpc/increment_hits?apikey=sb_publishable_EoB7MFJhCmb6PiAk-GPJ4w_PGhQ44Ru" class="iine-form">
  <input type="hidden" name="page_slug" value="&#x2F;blog&#x2F;ctf&#x2F;ex-cryptohack-hash&#x2F;">
  <button class="iine-button" type="submit" data-slug="&#x2F;blog&#x2F;ctf&#x2F;ex-cryptohack-hash&#x2F;" data-icon="thumbs_up"
    aria-label="Th√≠ch b√†i n√†y" title="Th√≠ch b√†i n√†y">üëç</button>
</form>

                
                
                    
                        
                        
                        
                    
                    
                        
                        
                        
                    
                
                
            <nav class="full-width article-navigation">
                <div><a href="https://thanhnc.id.vn/blog/ctf/ex-stack-bof/" aria-label="Ti·∫øp" aria-describedby="left_title"><span class="arrow">‚Üê</span>&nbsp;Ti·∫øp</a>
                <p aria-hidden="true" id="left_title">Pwn - Stack Buffer Overflow</p></div>
                <div><a href="https://thanhnc.id.vn/blog/ctf/lab-first-test/" aria-label="Tr∆∞·ªõc" aria-describedby="right_title">Tr∆∞·ªõc&nbsp;<span class="arrow">‚Üí</span></a>
                <p aria-hidden="true" id="right_title">School Lab: First Test - Web App &amp; Forensics</p></div>
            </nav>
        
        

        
            
            
            

            
                
                
            
        
            
            
            

            
        
            
            
            

            
        
            
            
            

            
        
        
            

<div id="comments" class="comments"


    data-repo="JakeClark-chan&#x2F;zola-my-id-vn"
    data-repo-id="R_kgDORXqQpA"
    data-category="General"
    data-category-id="DIC_kwDORXqQpM4C3Rqg"
    
        data-mapping="pathname"
    
    data-strict="1"
    data-reactions-enabled="1"
    
        data-input-position="top"
    
    data-light-theme="noborder_light"
    data-dark-theme="noborder_dark"
    
        data-lang="vi"
    
    data-lazy-loading="true"
    >




    <script src="https://thanhnc.id.vn/js/giscus.min.js" async></script>


<noscript>You need JavaScript to view the comments.</noscript>
</div>

        </article>
</main>

    <div id="button-container">
        
        
            <div id="toc-floating-container">
                <input type="checkbox" id="toc-toggle" class="toggle"/>
                <label for="toc-toggle" id="toc-button" class="button" title="·∫®n&#x2F;hi·ªán M·ª•c l·ª•c">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M414.82-193.094q-18.044 0-30.497-12.32-12.453-12.319-12.453-30.036t12.453-30.086q12.453-12.37 30.497-12.37h392.767q17.237 0 29.927 12.487 12.69 12.486 12.69 30.203 0 17.716-12.69 29.919t-29.927 12.203H414.82Zm0-244.833q-18.044 0-30.497-12.487Q371.87-462.9 371.87-480.45t12.453-29.92q12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.511 12.69 12.512 12.69 29.845 0 17.716-12.69 30.086-12.69 12.37-29.927 12.37H414.82Zm0-245.167q-18.044 0-30.497-12.32t-12.453-30.037q0-17.716 12.453-30.086 12.453-12.369 30.497-12.369h392.767q17.237 0 29.927 12.486 12.69 12.487 12.69 30.203 0 17.717-12.69 29.92-12.69 12.203-29.927 12.203H414.82ZM189.379-156.681q-32.652 0-55.878-22.829t-23.226-55.731q0-32.549 23.15-55.647 23.151-23.097 55.95-23.097 32.799 0 55.313 23.484 22.515 23.484 22.515 56.246 0 32.212-22.861 54.893-22.861 22.681-54.963 22.681Zm0-245.167q-32.652 0-55.878-23.134-23.226-23.135-23.226-55.623 0-32.487 23.467-55.517t56.12-23.03q32.102 0 54.721 23.288 22.62 23.288 22.62 55.775 0 32.488-22.861 55.364-22.861 22.877-54.963 22.877Zm-.82-244.833q-32.224 0-55.254-23.288-23.03-23.289-23.03-55.623 0-32.333 23.271-55.364 23.272-23.03 55.495-23.03 32.224 0 55.193 23.288 22.969 23.289 22.969 55.622 0 32.334-23.21 55.364-23.21 23.031-55.434 23.031Z"/></svg>
                </label>
                <div class="toc-content">
                    

<div class="toc-container">
    

    <ul>
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#jack-s-birthday-hash">Jack‚Äôs Birthday Hash</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#jack-s-birthday-confusion">Jack‚Äôs Birthday Confusion</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#collider">Collider</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#hash-stuffing">Hash Stuffing</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#primed5">PriMeD5</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#md0">MD0</a>
                    
                </li>
            
        
            
            
                <li><a href="https://thanhnc.id.vn/blog/ctf/ex-cryptohack-hash/#tong-ket">T·ªïng k·∫øt</a>
                    
                </li>
            
        
    </ul>
</div>


                </div>
            </div>
        

        
        <a href="#comments" id="comments-button" class="no-hover-padding" title="T·ªõi b√¨nh lu·∫≠n">
                <svg viewBox="0 0 20 20" fill="currentColor"><path d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd" fill-rule="evenodd"/></svg>
            </a>
        

        
        <a href="#" id="top-button" class="no-hover-padding" title="L√™n ƒë·∫ßu trang">
            <svg viewBox="0 0 20 20" fill="currentColor"><path d="M3.293 9.707a1 1 0 010-1.414l6-6a1 1 0 011.414 0l6 6a1 1 0 01-1.414 1.414L11 5.414V17a1 1 0 11-2 0V5.414L4.707 9.707a1 1 0 01-1.414 0z"/></svg>
        </a>
    </div>


<span id="copy-success" class="hidden">
        ƒê√£ ch√©p!
    </span>
    <span id="copy-init" class="hidden">
        Sao ch√©p code
    </span>
    <script defer src="https://thanhnc.id.vn/js/copyCodeToClipboard.min.js"></script>

<script defer src="https://cdn.jsdelivr.net/gh/welpo/iine@main/iine.mini.js"></script>
    </div>
    <footer>
    <section>
        <nav class="socials nav-navs"><ul><li>
                        <a class="nav-links no-hover-padding social" rel="" 

 href="https://thanhnc.id.vn/atom.xml">
                        <img loading="lazy" alt="feed" title="feed" src="https://thanhnc.id.vn/social_icons/rss.svg">
                        </a>
                    </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me" 

 href="mailto:contact@thanhnc.id.vn">
                                    <img loading="lazy" alt="email" title="email" src="https://thanhnc.id.vn/social_icons/email.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me" 

 href="https://github.com/JakeClark-chan">
                                    <img loading="lazy" alt="github" title="github" src="https://thanhnc.id.vn/social_icons/github.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me" 

 href="https://www.linkedin.com/in/ngchithanh">
                                    <img loading="lazy" alt="linkedin" title="linkedin" src="https://thanhnc.id.vn/social_icons/linkedin.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me" 

 href="https://facebook.com/nguyenchithanh21">
                                    <img loading="lazy" alt="facebook" title="facebook" src="https://thanhnc.id.vn/social_icons/facebook.svg">
                                </a>
                            </li>
                        
                            <li>
                                <a class="nav-links no-hover-padding social" rel=" me" 

 href="https://t.me/jakeclark38a">
                                    <img loading="lazy" alt="telegram" title="telegram" src="https://thanhnc.id.vn/social_icons/telegram.svg">
                                </a>
                            </li>
                        
                    
                </ul>
            
        </nav>

        
        <nav class="nav-navs">
                <small>
                    <ul>
                        
                        <li><a class="nav-links no-hover-padding" href="https:&#x2F;&#x2F;thanhnc.id.vn&#x2F;projects&#x2F;">
                                d·ª± √°n
                            </a>
                        </li>
                    
                        <li><a class="nav-links no-hover-padding" href="https:&#x2F;&#x2F;thanhnc.id.vn&#x2F;blog&#x2F;">
                                blog
                            </a>
                        </li>
                    
                        <li><a class="nav-links no-hover-padding" href="https:&#x2F;&#x2F;thanhnc.id.vn&#x2F;faq&#x2F;">
                                faq
                            </a>
                        </li>
                    
                    </ul>
                </small>
        
        </nav>

        <div class="credits">
            <small>
                

                
                ƒê∆∞·ª£c x√¢y d·ª±ng b·∫±ng
                <a rel="" 

 href="https://www.getzola.org">Zola</a>
                &amp;
                <a rel="" 

 href="https://github.com/welpo/tabi">tabi</a>

                </small>
        </div>
    </section>

    </footer>


    
    
</body>

</html>
